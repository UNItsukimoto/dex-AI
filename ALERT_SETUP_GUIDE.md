# アラート・通知システム設定ガイド

## 概要

AI取引システムにリアルタイムアラート機能が統合されました。重要な市場変化、取引シグナル、リスク警告を瞬時に通知します。

## 📊 実装された機能

### 🚨 アラートタイプ
- **取引シグナル**: 高信頼度の売買シグナル
- **リスク警告**: ポートフォリオリスク制限違反
- **価格変動**: 急激な価格変動（5%以上）
- **システムエラー**: API接続エラー等
- **パフォーマンス**: 予測精度の改善・悪化

### 📢 通知チャンネル
- **デスクトップ通知**: ✅ 利用可能
- **音声アラート**: ✅ 利用可能
- **メール通知**: 設定により利用可能
- **Slack通知**: 設定により利用可能

## ⚙️ 設定方法

### 1. 基本設定（自動有効）
デスクトップ通知と音声アラートは自動的に有効化されます。

### 2. メール通知設定
1. `alert_config.json`ファイルを作成
2. 以下の設定を追加：

```json
{
  "email_notifications": true,
  "email_config": {
    "smtp_server": "smtp.gmail.com",
    "smtp_port": 587,
    "username": "your-email@gmail.com",
    "password": "your-app-password",
    "to_emails": ["recipient@example.com"]
  }
}
```

**Gmail設定手順:**
1. Googleアカウント設定 → セキュリティ
2. 2段階認証を有効化
3. アプリパスワードを生成
4. 生成されたパスワードを使用

### 3. Slack通知設定
1. Slack Workspaceで Webhook URLを取得
2. 設定ファイルに追加：

```json
{
  "slack_notifications": true,
  "slack_config": {
    "webhook_url": "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
  }
}
```

## 🎛️ ダッシュボード操作

### アラートタブの機能
1. **アラート統計**: 24時間の通知履歴
2. **通知チャンネル**: 有効なチャンネル表示
3. **閾値設定**: アラート発生条件の調整
4. **テスト送信**: 通知システムの動作確認
5. **履歴表示**: 最近のアラート一覧

### テストアラート送信
「🧪 テストアラート送信」ボタンで通知システムをテストできます。

## 📊 アラート条件

### 取引シグナル
- 信頼度 ≥ 80%の予測シグナル
- BUY/SELL判定時に自動送信

### リスク警告
- 総エクスポージャー > 60%
- 最大ドローダウン > 20%
- ポジション集中リスク > 15%

### 価格変動
- 1回の更新で5%以上の価格変動
- 銘柄別に変動方向を通知

### システムエラー
- API接続失敗
- 予測エンジンエラー
- 取引実行エラー

## 🔧 カスタマイズ

### 閾値の調整
```json
{
  "thresholds": {
    "confidence_threshold": 0.8,     // 取引シグナル閾値
    "price_change_threshold": 0.05,  // 価格変動閾値（5%）
    "risk_score_threshold": 0.8      // リスクスコア閾値
  }
}
```

### 通知頻度制限
各アラートタイプは60秒のレート制限があります。

## 🚀 使用開始

1. **ダッシュボード起動**:
   ```bash
   streamlit run dashboard/risk_managed_dashboard.py
   ```

2. **「アラート」タブ**を開く

3. **「テストアラート送信」**でシステム確認

4. **取引実行**でリアルアラート開始

## 📱 通知例

### 取引シグナル
```
[TRADING_SIGNAL] BTC BUYシグナル
BTCでBUYシグナルを検出しました。
確率: 75.0%, 信頼度: 85.0%
```

### リスク警告
```
[RISK_WARNING] リスク警告: 総エクスポージャー
総エクスポージャーが制限値を超過しています。
現在値: 65.0%, 制限値: 60.0%
```

### 価格変動
```
[PRICE_ALERT] ETH 急騰
ETHが+8.0%の変動を記録しました。
現在価格: $3,200.00
```

## 🛠️ トラブルシューティング

### デスクトップ通知が表示されない
- Windows通知設定を確認
- アプリ通知許可を確認

### 音声が再生されない
- システム音量確認
- オーディオデバイス確認

### メール送信失敗
- ネットワーク接続確認
- SMTP設定確認
- アプリパスワード確認

### Slack通知失敗
- Webhook URL確認
- Slackワークスペース権限確認

## 💡 ベストプラクティス

1. **段階的有効化**: デスクトップ→音声→メール→Slackの順で設定
2. **閾値調整**: 最初は低めに設定して様子を見る
3. **テスト実行**: 定期的にテストアラートで動作確認
4. **履歴確認**: アラート履歴で市場動向を把握

これでAI取引システムのアラート機能が完全に利用可能になりました！